{% extends "base.html" %}

{% block title %}Revue Finale du CV{% endblock %}

{% block content %}
    <div class="w-full max-w-5xl mx-auto space-y-10">
      
      <h1 class="text-3xl font-extrabold text-gray-900 border-b pb-4 text-center">
          <span class="text-blue-600">üìÑ</span> Revue Finale & G√©n√©ration
      </h1>
      
      <p class="text-gray-600 text-center text-lg">V√©rifiez toutes vos informations avant de g√©n√©rer le document. Cliquez sur les boutons **Modifier** si vous trouvez une erreur.</p>

      <div class="flex flex-col md:flex-row justify-center gap-6 p-4 rounded-lg bg-indigo-50 border border-indigo-200 shadow-md">
          <a href="{{ url_for('generate_cv') }}" class="flex-1 text-center bg-green-600 text-white font-bold text-xl py-3 rounded-lg hover:bg-green-700 transition duration-150 shadow-lg transform hover:scale-[1.005]">
            üöÄ G√©n√©rer le CV Final (PDF)
          </a>
          <button onclick="window.location.href='{{ url_for('step1') }}'" class="flex-1 text-center bg-gray-600 text-white font-bold text-xl py-3 rounded-lg hover:bg-gray-700 transition duration-150 shadow-lg transform hover:scale-[1.005]">
            ‚úèÔ∏è Modifier (Retour √† l'√©tape 1)
          </button>
      </div>

      <div class="space-y-12">
          
        <div class="bg-white p-6 rounded-lg shadow-xl border border-gray-100">
            <div class="flex justify-between items-center border-b pb-3 mb-4">
                <h2 class="text-2xl font-semibold text-gray-800">1. Infos Personnelles & Langues</h2>
                <a href="{{ url_for('step1') }}" class="text-sm text-indigo-600 hover:text-indigo-800 font-medium">Modifier</a>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-gray-700">
                <div><span class="font-medium">Nom:</span> {{ session.personal_info.name | default('N/A') }}</div>
                <div><span class="font-medium">Email:</span> {{ session.personal_info.email | default('N/A') }}</div>
                <div><span class="font-medium">T√©l√©phone:</span> {{ session.personal_info.phone | default('N/A') }}</div>
                <div><span class="font-medium">LinkedIn:</span> <a href="{{ session.personal_info.linkedin }}" target="_blank" class="text-blue-500 hover:underline">{{ session.personal_info.linkedin | default('N/A') }}</a></div>
            </div>
            
            <h3 class="text-xl font-medium mt-6 mb-2 border-t pt-4">Langues ({{ session.languages | length if session.languages else 0 }})</h3>
            <ul class="list-disc pl-5 text-gray-600 space-y-1">
                {% for lang in session.languages %}
                <li>
                    <span class="font-medium">{{ lang.name }}</span> : 
                    {% if lang.speak %}Parl√©{% endif %}
                    {% if lang.read %}{% if lang.speak %}, {% endif %}Lu{% endif %}
                    {% if lang.write %}{% if lang.speak or lang.read %}, {% endif %}√âcrit{% endif %}
                </li>
                {% endfor %}
            </ul>
        </div>
        
        <div class="bg-white p-6 rounded-lg shadow-xl border border-gray-100">
            <div class="flex justify-between items-center border-b pb-3 mb-4">
                <h2 class="text-2xl font-semibold text-gray-800">2. Formations ({{ session.education | length if session.education else 0 }})</h2>
                <a href="{{ url_for('step2') }}" class="text-sm text-indigo-600 hover:text-indigo-800 font-medium">Modifier</a>
            </div>
            <div class="space-y-4">
                {% for edu in session.education %}
                <div class="p-3 border-l-4 border-blue-400 bg-blue-50/50 rounded-r-lg">
                    <p class="font-bold text-lg text-gray-900">{{ edu.degree }}</p>
                    <p class="text-gray-600">{{ edu.school }} ({{ edu.start_year }} - {{ edu.end_year if not edu.in_progress else 'En cours' }})</p>
                    {% if edu.thesis_subject %}<p class="text-sm italic mt-1">M√©moire: {{ edu.thesis_subject }}</p>{% endif %}
                </div>
                {% endfor %}
            </div>
        </div>

        <div class="bg-white p-6 rounded-lg shadow-xl border border-gray-100">
            <div class="flex justify-between items-center border-b pb-3 mb-4">
                <h2 class="text-2xl font-semibold text-gray-800">3. Comp√©tences ({{ session.skills | length if session.skills else 0 }})</h2>
                <a href="{{ url_for('step3') }}" class="text-sm text-indigo-600 hover:text-indigo-800 font-medium">Modifier</a>
            </div>
            <div class="flex flex-wrap gap-2">
                {% for skill in session.skills %}
                    <span class="px-3 py-1 bg-gray-200 text-gray-800 rounded-full text-sm font-medium">{{ skill }}</span>
                {% endfor %}
            </div>
        </div>

        <div class="bg-white p-6 rounded-lg shadow-xl border border-gray-100">
            <div class="flex justify-between items-center border-b pb-3 mb-4">
                <h2 class="text-2xl font-semibold text-gray-800">4. Exp√©riences ({{ session.experiences | length if session.experiences else 0 }})</h2>
                <a href="{{ url_for('step4') }}" class="text-sm text-indigo-600 hover:text-indigo-800 font-medium">Modifier</a>
            </div>
            <div class="space-y-4">
                {% for exp in session.experiences %}
                <div class="p-3 border-l-4 border-indigo-400 bg-indigo-50/50 rounded-r-lg">
                    <p class="font-bold text-lg text-gray-900">{{ exp.title }} chez {{ exp.company }}</p>
                    <p class="text-gray-600 text-sm">{{ exp.start_date }} - {{ exp.end_date if not exp.current else 'Actuellement' }} ({{ exp.type }})</p>
                    <p class="mt-2 text-sm text-gray-700">{{ exp.description | truncate(150) }}...</p>
                </div>
                {% endfor %}
            </div>
        </div>

        <div class="bg-white p-6 rounded-lg shadow-xl border border-gray-100">
            <div class="flex justify-between items-center border-b pb-3 mb-4">
                <h2 class="text-2xl font-semibold text-gray-800">5. Projets, Certifications & Divers</h2>
                <div class="flex gap-4">
                    <a href="{{ url_for('step5') }}" class="text-sm text-indigo-600 hover:text-indigo-800 font-medium">Modifier Projets</a>
                    <a href="{{ url_for('step6') }}" class="text-sm text-indigo-600 hover:text-indigo-800 font-medium">Modifier Certifs</a>
                </div>
            </div>
            
            <h3 class="text-xl font-medium mb-2">Projets ({{ session.distinctions | length if session.distinctions else 0 }})</h3>
            <ul class="list-disc pl-5 text-gray-600 space-y-1 mb-6">
                {% for dist in session.distinctions %}
                <li><span class="font-medium">{{ dist.title }}</span> ({{ dist.year }}) - {{ dist.type }}</li>
                {% endfor %}
            </ul>
            
            <h3 class="text-xl font-medium mt-4 mb-2 border-t pt-4">Certifications ({{ session.certifications | length if session.certifications else 0 }})</h3>
            <ul class="list-disc pl-5 text-gray-600 space-y-1">
                {% for cert in session.certifications %}
                <li><span class="font-medium">{{ cert.title }}</span> de {{ cert.issuer }} ({{ cert.year }})</li>
                {% endfor %}
            </ul>
        </div>
        
      </div>

      <div class="pt-6 border-t">
          <a href="{{ url_for('generate_cv') }}" class="w-full block text-center bg-green-600 text-white font-bold text-xl py-4 rounded-lg hover:bg-green-700 transition duration-150 shadow-lg">
            G√©n√©rer le CV Final (PDF) üöÄ
          </a>
      </div>
    </div>
{% endblock %}